var ee=Object.defineProperty;var te=(C,v,m)=>v in C?ee(C,v,{enumerable:!0,configurable:!0,writable:!0,value:m}):C[v]=m;var U=(C,v,m)=>te(C,typeof v!="symbol"?v+"":v,m);import{ct as E,cu as oe,k as se,a1 as P,cv as le,cw as ae,cx as re,f as ne,X as N,ag as ue,a5 as ie,G as ce,l as pe,g as p,o as i,i as s,Y as L,s as d,A as e,x as u,t as o,F as M,v as F,y as _,bE as w,q as I,ap as T,u as de,cy as he,cz as _e,cA as ve,_ as fe,az as A,bF as me,bG as ye}from"./confirm-B6YvaOPl.js";import{I as Ce,_ as Pe,E as be,c as ge}from"./ErrorMessage-ntYtpLOY.js";import{u as ke,i as O,H as B,T as f,a as R}from"./HorizontalSelector-DpRTNjkI.js";import{I as Ue}from"./InfoMessage-4hKsmdn8.js";class we{constructor(){U(this,"_reactive");U(this,"_currentProfileURI",E);U(this,"_customProfileList",oe());this._reactive=se(this)}get reactive(){return this._reactive}get currentProfileURI(){return this._currentProfileURI}get customLayoutProfiles(){return this._customProfileList.profiles}selectProfile(v){this._currentProfileURI=v,P.updateLayoutProfileList(this._currentProfileURI,this._customProfileList)}addCustomProfile(v){const m=le(this._customProfileList,v);this._currentProfileURI=m,P.updateLayoutProfileList(this._currentProfileURI,this._customProfileList)}duplicateCustomProfile(v){const m=ae(this._customProfileList,v);m&&(this._currentProfileURI=m,P.updateLayoutProfileList(this._currentProfileURI,this._customProfileList))}removeCustomProfile(v){re(this._customProfileList,v),this._currentProfileURI=E,P.updateLayoutProfileList(this._currentProfileURI,this._customProfileList)}updateCustomProfile(v,m){for(let g=0;g<this._customProfileList.profiles.length;g++)if(this._customProfileList.profiles[g].uri===v){this._customProfileList.profiles[g]=m,this._currentProfileURI=v;break}P.updateLayoutProfileList(this._currentProfileURI,this._customProfileList)}async setup(){[this._currentProfileURI,this._customProfileList]=await P.loadLayoutProfileList()}}function Ie(){return new we().reactive}let S;function z(){return S||(S=Ie()),S}const Re={class:"main full column"},Le={class:"header column"},Te=["value"],Be=["value"],Se=["value"],Ee={class:"row wrap buttons"},Ae={key:0,class:"custom-profile column grow scroll"},Ne={class:"column"},De=["value"],Ge={class:"uri row"},Me={class:"row"},Fe={class:"row"},Oe={class:"key"},ze={class:"row"},We=["value"],He={class:"row"},Ye={value:"Board"},qe={value:"Record"},Ve={value:"Book"},$e={value:"Chart"},Xe={value:"Analytics"},je={value:"Comment"},Je={value:"RecordInfo"},Ke={value:"ControlGroup1"},Qe={value:"ControlGroup2"},Ze={class:"name"},xe={key:0},et={key:1},tt={key:2},ot={key:3},st={key:4},lt={key:5},at={key:6},rt={key:7},nt={key:8},ut={class:"property"},it={class:"key"},ct=["value","onInput"],pt={class:"property"},dt={class:"key"},ht=["value","onInput"],_t={class:"property"},vt={class:"key"},ft=["value","onInput"],mt={class:"property"},yt={class:"key"},Ct=["value","onInput"],Pt={key:0},bt={class:"property"},gt={class:"property"},kt={key:1},Ut={class:"property"},wt={class:"property"},It={class:"property"},Rt={class:"property"},Lt={key:2},Tt={class:"property"},Bt={class:"property"},St={key:3},Et={class:"property"},At={class:"property"},Nt={class:"property"},Dt={class:"property"},Gt={class:"property"},Mt={class:"property"},Ft={class:"property"},Ot={class:"property"},zt={class:"property"},Wt={key:4},Ht={class:"property"},Yt=["onClick"],qt=["onClick"],Vt=["onClick"],$t=ne({__name:"LayoutManager",setup(C){const v=N(),m=ke(),g=ue(),D=ie(),c=z(),G=ce(),y=pe(()=>c.customLayoutProfiles.find(r=>r.uri===c.currentProfileURI)),W=r=>{const a=r.target;c.selectProfile(a.value)},H=()=>{c.addCustomProfile()},Y=()=>{c.duplicateCustomProfile(c.currentProfileURI)},q=()=>{c.currentProfileURI.startsWith(he)&&D.show({message:o.areYouSureWantToRemoveCurrentProfile,onOk:()=>{c.removeCustomProfile(c.currentProfileURI)}})},b=()=>c.customLayoutProfiles.find(r=>r.uri===c.currentProfileURI),V=()=>{const r=b();if(r){const a=_e(r);navigator.clipboard.writeText(a),m.enqueue({text:o.profileExportedToClipboard})}},$=async()=>{try{const r=await navigator.clipboard.readText(),a=ve(r);c.addCustomProfile(a),m.enqueue({text:o.profileImported})}catch{g.add(new Error(o.failedToImportProfile))}},X=()=>{const r=b();r&&navigator.clipboard.writeText(r.uri)},j=async()=>{const r=b();if(r)try{await P.createDesktopShortcutForLayoutProfile(r.uri,r.name),m.enqueue({text:o.desktopShortcutCreated})}catch(a){g.add(a)}},k=(r,a)=>{const t=b();t&&c.updateCustomProfile(c.currentProfileURI,{...t,[r]:a})},h=(r,a,t)=>{const n=b();n&&c.updateCustomProfile(c.currentProfileURI,{...n,components:n.components.map((l,x)=>x!==r?l:{...l,[a]:t})})},J=r=>{const a=b();if(!a||r<=0)return;const t=[...a.components],n=t[r-1];t[r-1]=t[r],t[r]=n,c.updateCustomProfile(c.currentProfileURI,{...a,components:t})},K=r=>{const a=b();if(!a||r>=a.components.length-1)return;const t=[...a.components],n=t[r+1];t[r+1]=t[r],t[r]=n,c.updateCustomProfile(c.currentProfileURI,{...a,components:t})},Q=r=>{const a=b();a&&c.updateCustomProfile(c.currentProfileURI,{...a,components:a.components.filter((t,n)=>n!==r)})},Z=()=>{const r=b();if(!r)return;const a=[...r.components],t=G.value.value;switch(t){case"Board":a.unshift({type:t,left:0,top:0,width:800,height:600});break;case"Record":a.unshift({type:"Record",left:0,top:0,width:400,height:500});break;case"Book":a.unshift({type:"Book",left:0,top:0,width:500,height:250});break;case"Chart":a.unshift({type:"Chart",left:0,top:0,width:600,height:300,chartType:T.RAW});break;case"Analytics":a.unshift({type:"Analytics",left:0,top:0,width:600,height:300});break;case"Comment":a.unshift({type:t,left:0,top:0,width:250,height:250});break;case"RecordInfo":a.unshift({type:t,left:0,top:0,width:400,height:300});break;case"ControlGroup1":case"ControlGroup2":a.unshift({type:t,left:0,top:0,width:150,height:200});break}c.updateCustomProfile(c.currentProfileURI,{...r,components:a})};return(r,a)=>(i(),p("div",{class:de(["root full",e(v).thema])},[s("div",Re,[s("div",Le,[s("select",{value:e(c).currentProfileURI,onChange:W},[s("option",{value:E},u(e(o).standard),9,Be),(i(!0),p(M,null,F(e(c).customLayoutProfiles,(t,n)=>(i(),p("option",{key:n,value:t.uri},u(t.name),9,Se))),128))],40,Te),s("div",Ee,[s("button",{class:"thin",onClick:H},u(e(o).addCustomLayoutProfile),1),y.value?(i(),p("button",{key:0,class:"thin",onClick:Y},u(e(o).duplicateCurrentProfile),1)):d("",!0),y.value?(i(),p("button",{key:1,class:"thin",onClick:q},u(e(o).removeCurrentProfile),1)):d("",!0),y.value?(i(),p("button",{key:2,class:"thin",onClick:V},u(e(o).exportProfileToClipboard),1)):d("",!0),s("button",{class:"thin",onClick:$},u(e(o).importProfileFromClipboard),1)])]),y.value?(i(),p("div",Ae,[s("div",Ne,[s("input",{class:"profile-name",value:y.value.name,onInput:a[0]||(a[0]=t=>k("name",e(O)(t)))},null,40,De),s("div",Ge,[a[5]||(a[5]=s("span",null,"URI:",-1)),s("span",null,u(y.value.uri),1),s("button",{onClick:X},[_(Pe,{icon:e(Ce).COPY},null,8,["icon"])])]),s("div",Me,[s("button",{onClick:j},u(e(o).createDesktopShortcut),1)])]),s("div",Fe,[s("span",Oe,u(e(o).dialogPosition)+":",1),_(B,{value:y.value.dialogPosition||e(w).CENTER,items:[{label:e(o).alignLeft,value:e(w).LEFT},{label:e(o).alignCenter,value:e(w).CENTER},{label:e(o).alignRight,value:e(w).RIGHT}],"onUpdate:value":a[1]||(a[1]=t=>k("dialogPosition",t))},null,8,["value","items"])]),s("div",ze,[_(f,{class:"color-toggle",value:!!y.value.backgroundColor,label:e(o).backgroundColor,"onUpdate:value":a[2]||(a[2]=t=>k("backgroundColor",t?"#000000":void 0))},null,8,["value","label"]),y.value.backgroundColor?(i(),p("input",{key:0,class:"color-selector",type:"color",value:y.value.backgroundColor,onInput:a[3]||(a[3]=t=>k("backgroundColor",e(O)(t)))},null,40,We)):d("",!0),_(f,{class:"backdrop-toggle",value:!!y.value.dialogBackdrop,label:e(o).dialogBackdrop,"onUpdate:value":a[4]||(a[4]=t=>k("dialogBackdrop",t))},null,8,["value","label"])]),s("div",He,[s("select",{ref_key:"newComponentType",ref:G,size:"1"},[s("option",Ye,u(e(o).board),1),s("option",qe,u(e(o).record),1),s("option",Ve,u(e(o).book),1),s("option",$e,u(e(o).chart),1),s("option",Xe,u(e(o).analytics),1),s("option",je,u(e(o).comments),1),s("option",Je,u(e(o).recordProperties),1),s("option",Ke,u(e(o).controlGroup)+"1",1),s("option",Qe,u(e(o).controlGroup)+"2",1)],512),s("button",{class:"thin",onClick:Z},u(e(o).insert),1)]),(i(!0),p(M,null,F(y.value.components,(t,n)=>(i(),p("div",{key:n,class:"component"},[s("div",Ze,[t.type==="Board"?(i(),p("span",xe,u(e(o).board),1)):d("",!0),t.type==="Record"?(i(),p("span",et,u(e(o).record),1)):d("",!0),t.type==="Book"?(i(),p("span",tt,u(e(o).book),1)):d("",!0),t.type==="Chart"?(i(),p("span",ot,u(e(o).chart),1)):d("",!0),t.type==="Analytics"?(i(),p("span",st,u(e(o).analytics),1)):d("",!0),t.type==="Comment"?(i(),p("span",lt,u(e(o).comments),1)):d("",!0),t.type==="RecordInfo"?(i(),p("span",at,u(e(o).recordProperties),1)):d("",!0),t.type==="ControlGroup1"?(i(),p("span",rt,u(e(o).controlGroup)+"1",1)):d("",!0),t.type==="ControlGroup2"?(i(),p("span",nt,u(e(o).controlGroup)+"2",1)):d("",!0)]),s("div",null,[s("span",ut,[s("span",it,u(e(o).left)+":",1),s("input",{class:"value",type:"number",value:t.left,onInput:l=>h(n,"left",e(R)(l))},null,40,ct)]),s("span",pt,[s("span",dt,u(e(o).top)+":",1),s("input",{class:"value",type:"number",value:t.top,onInput:l=>h(n,"top",e(R)(l))},null,40,ht)]),s("span",_t,[s("span",vt,u(e(o).width)+":",1),s("input",{class:"value",type:"number",value:t.width,onInput:l=>h(n,"width",e(R)(l))},null,40,ft)]),s("span",mt,[s("span",yt,u(e(o).height)+":",1),s("input",{class:"value",type:"number",value:t.height,onInput:l=>h(n,"height",e(R)(l))},null,40,Ct)])]),t.type==="Board"?(i(),p("div",Pt,[s("span",bt,[_(f,{value:!!t.rightControlBox,label:e(o).rightControlBox,"onUpdate:value":l=>h(n,"rightControlBox",l)},null,8,["value","label","onUpdate:value"])]),s("span",gt,[_(f,{value:!!t.leftControlBox,label:e(o).leftControlBox,"onUpdate:value":l=>h(n,"leftControlBox",l)},null,8,["value","label","onUpdate:value"])]),s("span",null,[_(B,{value:t.layoutType||e(I).STANDARD,items:[{label:e(o).standard,value:e(I).STANDARD},{label:e(o).compact,value:e(I).COMPACT},{label:e(o).portrait,value:e(I).PORTRAIT}],"onUpdate:value":l=>h(n,"layoutType",l)},null,8,["value","items","onUpdate:value"])])])):d("",!0),t.type==="Record"?(i(),p("div",kt,[s("span",Ut,[_(f,{value:!!t.showCommentColumn,label:e(o).comments,"onUpdate:value":l=>h(n,"showCommentColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",wt,[_(f,{value:!!t.showElapsedTimeColumn,label:e(o).elapsedTime,"onUpdate:value":l=>h(n,"showElapsedTimeColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",It,[_(f,{value:!!t.topControlBox,label:e(o).topControlBox,"onUpdate:value":l=>h(n,"topControlBox",l)},null,8,["value","label","onUpdate:value"])]),s("span",Rt,[_(f,{value:!!t.branches,label:e(o).branches,"onUpdate:value":l=>h(n,"branches",l)},null,8,["value","label","onUpdate:value"])])])):d("",!0),t.type==="Chart"?(i(),p("div",Lt,[s("span",Tt,[_(B,{value:t.chartType,items:[{label:e(o).rawScore,value:e(T).RAW},{label:e(o).estimatedWinRate,value:e(T).WIN_RATE}],"onUpdate:value":l=>h(n,"chartType",l)},null,8,["value","items","onUpdate:value"])]),s("span",Bt,[_(f,{value:!!t.showLegend,label:e(o).legends,"onUpdate:value":l=>h(n,"showLegend",l)},null,8,["value","label","onUpdate:value"])])])):d("",!0),t.type==="Analytics"?(i(),p("div",St,[s("span",Et,[_(f,{value:!!t.historyMode,label:e(o).historyMode,"onUpdate:value":l=>h(n,"historyMode",l)},null,8,["value","label","onUpdate:value"])]),s("span",At,[_(f,{value:!!t.showHeader,label:e(o).headers,"onUpdate:value":l=>h(n,"showHeader",l)},null,8,["value","label","onUpdate:value"])]),s("span",Nt,[_(f,{value:!!t.showTimeColumn,label:e(o).elapsedTime,"onUpdate:value":l=>h(n,"showTimeColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",Dt,[_(f,{value:!!t.showMultiPvColumn,label:e(o).rank,"onUpdate:value":l=>h(n,"showMultiPvColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",Gt,[_(f,{value:!!t.showDepthColumn,label:e(o).depth,"onUpdate:value":l=>h(n,"showDepthColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",Mt,[_(f,{value:!!t.showNodesColumn,label:e(o).nodes,"onUpdate:value":l=>h(n,"showNodesColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",Ft,[_(f,{value:!!t.showScoreColumn,label:e(o).score,"onUpdate:value":l=>h(n,"showScoreColumn",l)},null,8,["value","label","onUpdate:value"])]),s("span",Ot,[_(f,{value:!!t.showPlayButton,label:e(o).playButton,"onUpdate:value":l=>h(n,"showPlayButton",l)},null,8,["value","label","onUpdate:value"])]),s("span",zt,[_(f,{value:!!t.showSuggestionsCount,label:e(o).suggestionsCount,"onUpdate:value":l=>h(n,"showSuggestionsCount",l)},null,8,["value","label","onUpdate:value"])])])):d("",!0),t.type==="Comment"?(i(),p("div",Wt,[s("span",Ht,[_(f,{value:!!t.showBookmark,label:e(o).bookmark,"onUpdate:value":l=>h(n,"showBookmark",l)},null,8,["value","label","onUpdate:value"])])])):d("",!0),s("div",null,[n!==0?(i(),p("button",{key:0,class:"thin",onClick:()=>J(n)}," ↑ "+u(e(o).bringForward),9,Yt)):d("",!0),n!==y.value.components.length-1?(i(),p("button",{key:1,class:"thin",onClick:()=>K(n)}," ↓ "+u(e(o).sendBackward),9,qt)):d("",!0),s("button",{class:"thin",onClick:()=>Q(n)},u(e(o).remove),9,Vt)])]))),128))])):d("",!0)]),e(m).hasMessage?(i(),L(Ue,{key:0})):d("",!0),e(g).hasError?(i(),L(be,{key:1})):d("",!0),e(D).message?(i(),L(ge,{key:2})):d("",!0)],2))}}),Xt=fe($t,[["__scopeId","data-v-eb94868d"]]);P.log(A.INFO,"start renderer process (layout manager)");const jt=z(),Jt=N();Promise.allSettled([jt.setup(),Jt.loadAppSettings().catch(C=>{P.log(A.ERROR,"アプリ設定の読み込み中にエラーが発生しました: "+C)})]).finally(()=>{const C=N().language;me(C),P.log(A.INFO,"mount app (layout manager)"),ye(Xt).mount("#app")});
